# 테스트를 이용한 신뢰성 향상

> 단위 테스트 슈트 설계<br>
입력 커버리지 기준 적용<br>
코드 커버리지 측정<br>
코드 테스트 용이성 평가와 개선<br>

## 테스트의 기본적 개념
테스트의 목표
- 많은 버그를 찾아내 제거
- 프로그램의 정확성과 견고성을 개선할 수 있다.

### 테스트 커버리지
커버리지
- 테스트가 시스템의 다른 부분을 시뮬레이션 할 수 있는 정도.

커버리지 측정
- 코드 기반 커버리지
    - 주어진 테스트 집합에서 한 번이라도 `실행되는 소스 코드의 비율`
    - 화이트박스 테스트
        - 테스트할 소프트웨어의 내부 관련 지식과 소스코드를 알고 있다고 가정.
- 입력 기반 커버리지
    - 테스트할 프로그램의 내부는 무시하고 `API`에 집중
    - 입력의 전체 집합을 분석하고 전체를 대표하는 더 작은 값의 집합을 도출
    - 블랙박스 테스트

2가지 커버리지는 서로 보완하는 관계<br>
<br>
`입력 기반 커버리지`를 목표로, 테스트 계획 자체를 검증하는 방법으로 `코드 기반 커버리지` 활용

### 테스트와 계약에 의한 설계
실전에서 테스트를 더 활용하는 2가지 이유
- `불변 조건`과 `사후 조건` 검사를 클래스 밖으로 옮길 수 있다.
    - `클래스`를 작고 단순하게 유지할 수 있다.
    - `책임 경계`가 명확해진다.
    - 개발과 테스트를 다른 팀에 맡길 수 있다.
- 테스트를 하려면 입력 값의 집합을 `세심하게` 설계해야 한다.
    - `다양한 입력으로 호출`하는 방법이 없으면 프로그램 `개발`과 `배포` 어느 단계에서도 버그를 찾지 못한다.
- 이 과정을 책임져야 하며 커버리지 척도를 바탕으로 정확성과 견고성의 `신뢰도`를 가늠할 수 있다.

안전성이 중요한 코드에서는 `불변 조건 검사`를 이용해 상태를 확인할 수 있다.

### JUnit
자바의 표준 단위 테스트 프레임워크<br>
<br>

- 테스트에서 예외를 던진다면
    - `@Test`의 expected 속성에 예상되는 예외 클래스를 지정해 JUnit에 알린다.

![IMG_BF59E3E8773C-1](https://user-images.githubusercontent.com/73376468/153616672-9097f367-3f3b-4de1-8301-5769913380cc.jpeg)

- 테스트 메서드는 값을 리턴하지 않는다.
- JUnit의 assertion
    - 연산 결과로 기대되는 값과 실제 얻은 값을 비교하기 위해 프레임워크에서 제공하는 정적 메서드

### JUnit Method
- assertTure : 조건이 참이면 테스트 성공.
- assertFalse : 조건이 거짓이면 성공.
- assertEquals(String message, Object expected, Object actual) : `expected`와 `actual` 둘 다 null, 서로 같으면 성공.
- assertEquals(String message, double expected, double actual, double delta) : `expected`와 `actual`이 `delta`만큼 오차 안에 있으면 성공. `delta`는 비교할 때 허용되는 오차. `부동 소수점 수`는 직접 비교하면 안 되고 오차를 고려해 비교해야함.

### 테스트 초기화
@Before
- 매번 테스트를 실행하기 전에 실행됨
- 각 테스트를 초기화한다.

@BeforeClass
- 테스트 시작시 한 번 호출

@After
- 매번 테스트 완료시 호출

@AfterClass
- 테스트 완료시 한 번 호출

### Hamcrest 매처를 이용한 가독성 높은 어서션

```java
assertEquals(theBiscuit, myBiscuit);

// 아래 세 줄의 코드는 위와 같다.
assertThat(theBiscuit, equalTo(myBiscuit));
assertThat(theBiscuit, is(equalTo(myBiscuit)));
assertThat(theBiscuit, is(myBiscuit));
```
- `is` 나 `equalTo`를 사용해 가독성 있게 바꿀 수 있다.

`Matcher` 에 다양한 method가 있다.

### addWater 테스트
[도메인 모델이란](https://javacan.tistory.com/entry/what-is-a-domain-model)






### 돌발 퀴즈 1
Q) 메서드 계약의 어느 부분이 메서드 테스트와 관련 있는가?<br>
-> 

### 돌발 퀴즈 2
Q) 날짜를 표현하는 데이터 타입에는 어떠한 특성이 있을까?<br>
-> 

### 돌발 퀴즈 2
Q) 독립적인 세 특성이 존재하고 각 특성에 따른 블록 개수가 n1, n2, n3이라면 전체 조합 커버리지를 달성하는데 몇 개의 테스트가 필요한가? 개별 선택 커버리지와 기반 선택 커버리지에는 몇 개의 테스트가 필요한가?<br>
-> 

